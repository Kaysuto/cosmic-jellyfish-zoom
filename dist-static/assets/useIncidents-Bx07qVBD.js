var m=(t,c,r)=>new Promise((i,s)=>{var l=e=>{try{o(r.next(e))}catch(a){s(a)}},u=e=>{try{o(r.throw(e))}catch(a){s(a)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(l,u);o((r=r.apply(t,c)).next())});import{r as n}from"./router-42GXI50n.js";import{s as d}from"./index-Cw6WSGfP.js";const v=()=>{const[t,c]=n.useState([]),[r,i]=n.useState(!0),s=n.useCallback(()=>m(null,null,function*(){const{data:e,error:a}=yield d.from("incidents").select("*, services(name), profiles!author_id(first_name, last_name, email, avatar_url)").order("position");a?console.error("Erreur lors de la récupération des incidents:",a):c(e||[]),i(!1)}),[]);n.useEffect(()=>{s();const e=d.channel("incidents-changes").on("postgres_changes",{event:"*",schema:"public",table:"incidents"},()=>{s()}).subscribe();return()=>{d.removeChannel(e)}},[s]);const l=n.useCallback(()=>{s()},[s]),u=n.useMemo(()=>t.filter(e=>e.status!=="resolved"&&e.status!=="postmortem"),[t]),o=n.useMemo(()=>t.filter(e=>e.status==="resolved"),[t]);return{incidents:t,loading:r,refreshIncidents:l,activeIncidents:u,resolvedIncidents:o}};export{v as u};
//# sourceMappingURL=useIncidents-Bx07qVBD.js.map
