var g=Object.defineProperty;var L=(r,t,i)=>t in r?g(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var p=(r,t,i)=>L(r,typeof t!="symbol"?t+"":t,i);var u=(r,t,i)=>new Promise((e,o)=>{var h=n=>{try{d(i.next(n))}catch(v){o(v)}},s=n=>{try{d(i.throw(n))}catch(v){o(v)}},d=n=>n.done?e(n.value):Promise.resolve(n.value).then(h,s);d((i=i.apply(r,t)).next())});import{i as a,t as m,D as f,v as S,w,x as y,y as E,z as H,p as j}from"./streaming-fF1zHaJi.js";import{VideoProvider as D}from"./provider-pkq8ONR5.js";import{a as C}from"./provider-2S-Iw40p.js";import"./router-42GXI50n.js";import"./vendor-aQ18W7Az.js";class ${constructor(t,i,e){this.Bh=t,this.ph=i,this.jf=e,this.Ch()}Ch(){return u(this,null,function*(){const t={onLoadStart:this.ge.bind(this),onLoaded:this.ue.bind(this),onLoadError:this.Dh.bind(this)};let i=yield I(this.Bh,t);if(a(i)&&!m(this.Bh)&&(i=yield B(this.Bh,t)),!i)return null;if(!i.isSupported()){const e="[vidstack]: `hls.js` is not supported in this environment";return this.ph.player.dispatchEvent(new f("hls-unsupported")),this.ph.delegate.p("error",{detail:{message:e,code:4}}),null}return i})}ge(){this.ph.player.dispatchEvent(new f("hls-lib-load-start"))}ue(t){this.ph.player.dispatchEvent(new f("hls-lib-loaded",{detail:t})),this.jf(t)}Dh(t){const i=S(t);this.ph.player.dispatchEvent(new f("hls-lib-load-error",{detail:i})),this.ph.delegate.p("error",{detail:{message:i.message,code:4}})}}function B(i){return u(this,arguments,function*(r,t={}){var e,o,h,s,d;if(!a(r)){if((e=t.onLoadStart)==null||e.call(t),r.prototype&&r.prototype!==Function)return(o=t.onLoaded)==null||o.call(t,r),r;try{const n=(h=yield r())==null?void 0:h.default;if(n&&n.isSupported)(s=t.onLoaded)==null||s.call(t,n);else throw Error("");return n}catch(n){(d=t.onLoadError)==null||d.call(t,n)}}})}function I(i){return u(this,arguments,function*(r,t={}){var e,o,h;if(m(r)){(e=t.onLoadStart)==null||e.call(t);try{if(yield w(r),!y(window.Hls))throw Error("");const s=window.Hls;return(o=t.onLoaded)==null||o.call(t,s),s}catch(s){(h=t.onLoadError)==null||h.call(t,s)}}})}const P="https://cdn.jsdelivr.net";class R extends D{constructor(){super(...arguments);p(this,"$$PROVIDER_TYPE","HLS");p(this,"mh",null);p(this,"od",new C(this.video));p(this,"lh",`${P}/npm/hls.js@^1.0.0/dist/hls.min.js`)}get ctor(){return this.mh}get instance(){return this.od.instance}get type(){return"hls"}get canLiveSync(){return!0}get config(){return this.od.nh}set config(i){this.od.nh=i}get library(){return this.lh}set library(i){this.lh=i}preconnect(){m(this.lh)&&H(this.lh)}setup(i){super.setup(i),new $(this.lh,i,e=>{this.mh=e,this.od.setup(e,i),i.delegate.p("provider-setup",{detail:this});const o=j(i.$store.source);o&&this.loadSource(o)})}loadSource(e){return u(this,arguments,function*({src:i}){var o;m(i)&&((o=this.od.instance)==null||o.loadSource(i))})}onInstance(i){const e=this.od.instance;return e&&i(e),this.od.oh.add(i),()=>this.od.oh.delete(i)}destroy(){this.od.Jg()}}p(R,"supported",E());export{R as HLSProvider};
//# sourceMappingURL=provider-4ZxKCpH7.js.map
