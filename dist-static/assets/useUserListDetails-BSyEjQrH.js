var K=Object.defineProperty,M=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var w=(a,t,e)=>t in a?K(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,E=(a,t)=>{for(var e in t||(t={}))U.call(t,e)&&w(a,e,t[e]);if(h)for(var e of h(t))z.call(t,e)&&w(a,e,t[e]);return a},L=(a,t)=>M(a,T(t));var v=(a,t,e)=>new Promise((o,n)=>{var _=s=>{try{d(e.next(s))}catch(r){n(r)}},l=s=>{try{d(e.throw(s))}catch(r){n(r)}},d=s=>s.done?o(s.value):Promise.resolve(s.value).then(_,l);d((e=e.apply(a,t)).next())});import{r as m}from"./router-42GXI50n.js";import{a as B,u as F,s as u,d as D}from"./index-Cw6WSGfP.js";const J=(a,t)=>{const{session:e}=B(),{t:o,i18n:n}=F(),[_,l]=m.useState([]),[d,s]=m.useState(!0),r=m.useCallback(()=>v(null,null,function*(){if(!a)return;s(!0);const{data:c,error:S}=yield u.from("user_media_list").select("media_id, media_type").eq("user_id",a).eq("list_type",t);if(S){D(o("error_fetching_list")),s(!1);return}if(c.length===0){l([]),s(!1);return}const{data:j,error:k}=yield u.functions.invoke("get-media-list-details",{body:{mediaList:c,language:n.language}});if(k)D(o("error_fetching_list"));else{const q=c.map(i=>i.media_id),{data:g,error:x}=yield u.from("catalog_items").select("tmdb_id, media_type, jellyfin_id").in("tmdb_id",q),p=(i,f)=>`${i}:${f||""}`,y=new Map;if(!x&&g)for(const i of g)y.set(p(i.tmdb_id,i.media_type),!!i.jellyfin_id);const $=j.map(i=>{var b;const f=(b=c.find(C=>C.media_id===i.id))==null?void 0:b.media_type,A=y.get(p(i.id,f))||!1;return L(E({},i),{media_type:f,isAvailable:A})});l($)}s(!1)}),[a,t,o,n.language]);return m.useEffect(()=>{r()},[r]),{list:_,loading:d,refetch:r}};export{J as u};
//# sourceMappingURL=useUserListDetails-BSyEjQrH.js.map
