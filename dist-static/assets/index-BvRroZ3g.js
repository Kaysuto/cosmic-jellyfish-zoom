var H=Object.defineProperty;var z=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var I=(n,t,e)=>t in n?H(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,L=(n,t)=>{for(var e in t||(t={}))K.call(t,e)&&I(n,e,t[e]);if(z)for(var e of z(t))U.call(t,e)&&I(n,e,t[e]);return n};import{j as R}from"./ui-DslYdUPK.js";import{r as s}from"./router-42GXI50n.js";import{am as b,an as q,ao as S,ap as B,aq as F,ar as G,as as T}from"./index-Cw6WSGfP.js";class V extends s.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent){const i=e.offsetParent,m=q(i)&&i.offsetWidth||0,r=this.props.sizeRef.current;r.height=e.offsetHeight||0,r.width=e.offsetWidth||0,r.top=e.offsetTop,r.left=e.offsetLeft,r.right=m-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function X({children:n,isPresent:t,anchorX:e,root:i}){const m=s.useId(),r=s.useRef(null),p=s.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:g}=s.useContext(b);return s.useInsertionEffect(()=>{const{width:y,height:o,top:C,left:f,right:u}=p.current;if(t||!r.current||!y||!o)return;const a=e==="left"?`left: ${f}`:`right: ${u}`;r.current.dataset.motionPopId=m;const c=document.createElement("style");g&&(c.nonce=g);const d=i!=null?i:document.head;return d.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${y}px !important;
            height: ${o}px !important;
            ${a}px !important;
            top: ${C}px !important;
          }
        `),()=>{d.contains(c)&&d.removeChild(c)}},[t]),R.jsx(V,{isPresent:t,childRef:r,sizeRef:p,children:s.cloneElement(n,{ref:r})})}const _=({children:n,initial:t,isPresent:e,onExitComplete:i,custom:m,presenceAffectsLayout:r,mode:p,anchorX:g,root:y})=>{const o=S(J),C=s.useId();let f=!0,u=s.useMemo(()=>(f=!1,{id:C,initial:t,isPresent:e,custom:m,onExitComplete:a=>{o.set(a,!0);for(const c of o.values())if(!c)return;i&&i()},register:a=>(o.set(a,!1),()=>o.delete(a))}),[e,o,i]);return r&&f&&(u=L({},u)),s.useMemo(()=>{o.forEach((a,c)=>o.set(c,!1))},[e]),s.useEffect(()=>{!e&&!o.size&&i&&i()},[e]),p==="popLayout"&&(n=R.jsx(X,{isPresent:e,anchorX:g,root:y,children:n})),R.jsx(B.Provider,{value:u,children:n})};function J(){return new Map}const P=n=>n.key||"";function k(n){const t=[];return s.Children.forEach(n,e=>{s.isValidElement(e)&&t.push(e)}),t}const Z=({children:n,custom:t,initial:e=!0,onExitComplete:i,presenceAffectsLayout:m=!0,mode:r="sync",propagate:p=!1,anchorX:g="left",root:y})=>{const[o,C]=F(p),f=s.useMemo(()=>k(n),[n]),u=p&&!o?[]:f.map(P),a=s.useRef(!0),c=s.useRef(f),d=S(()=>new Map),[W,A]=s.useState(f),[x,$]=s.useState(f);G(()=>{a.current=!1,c.current=f;for(let h=0;h<x.length;h++){const l=P(x[h]);u.includes(l)?d.delete(l):d.get(l)!==!0&&d.set(l,!1)}},[x,u.length,u.join("-")]);const w=[];if(f!==W){let h=[...f];for(let l=0;l<x.length;l++){const E=x[l],j=P(E);u.includes(j)||(h.splice(l,0,E),w.push(E))}return r==="wait"&&w.length&&(h=w),$(k(h)),A(f),null}const{forceRender:M}=s.useContext(T);return R.jsx(R.Fragment,{children:x.map(h=>{const l=P(h),E=p&&!o?!1:f===x||u.includes(l),j=()=>{if(d.has(l))d.set(l,!0);else return;let v=!0;d.forEach(D=>{D||(v=!1)}),v&&(M==null||M(),$(c.current),p&&(C==null||C()),i&&i())};return R.jsx(_,{isPresent:E,initial:!a.current||e?void 0:!1,custom:t,presenceAffectsLayout:m,mode:r,root:y,onExitComplete:E?void 0:j,anchorX:g,children:h},l)})})};export{Z as A};
//# sourceMappingURL=index-BvRroZ3g.js.map
