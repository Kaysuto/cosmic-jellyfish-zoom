var I=Object.defineProperty,z=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var w=(e,r,a)=>r in e?I(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,x=(e,r)=>{for(var a in r||(r={}))U.call(r,a)&&w(e,a,r[a]);if(h)for(var a of h(r))A.call(r,a)&&w(e,a,r[a]);return e},j=(e,r)=>z(e,R(r));var b=(e,r,a)=>new Promise((p,c)=>{var g=o=>{try{n(a.next(o))}catch(l){c(l)}},u=o=>{try{n(a.throw(o))}catch(l){c(l)}},n=o=>o.done?p(o.value):Promise.resolve(o.value).then(g,u);n((a=a.apply(e,r)).next())});import{j as s}from"./ui-DslYdUPK.js";import{u as B,r as m,L as D}from"./router-42GXI50n.js";import{o as M,s as y,u as O,t as $,F as q,a as _,b as N,c as v,d as C,e as F}from"./form-Ba3HuSxU.js";import{u as H,a as J,m as K,C as V,n as Z,o as G,I as Q,p as W,J as X,B as S,s as Y,d as ss,K as es}from"./index-Cw6WSGfP.js";import{I as L}from"./input-B7M3MPRI.js";import{T as rs}from"./triangle-alert-bjg6MAJf.js";import{L as as}from"./loader-circle-BQi2R5hk.js";import"./vendor-aQ18W7Az.js";import"./label-BjJg9FZ3.js";import"./utils-D-N2hrcs.js";import"./streaming-fF1zHaJi.js";const fs=()=>{const{t:e,i18n:r}=H(),a=B(),[p,c]=m.useState(!1),{session:g,loading:u}=J(),[n,o]=m.useState(null);m.useEffect(()=>{const t=window.location.hash.substring(1);if(t){const d=new URLSearchParams(t),T=d.get("error_code"),f=d.get("error_description");T==="otp_expired"?o(e("email_link_expired")):f&&o(f.replace(/\+/g," "))}},[e]);const l=!u&&g&&!n,P=m.useMemo(()=>M({password:y().min(6,{message:e("password_too_short")}).regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$/,{message:e("password_requirements")}),confirmPassword:y()}).refine(t=>t.password===t.confirmPassword,{message:e("passwords_do_not_match"),path:["confirmPassword"]}),[r.language]),i=O({resolver:$(P),defaultValues:{password:"",confirmPassword:""}});m.useEffect(()=>{Object.keys(i.formState.errors).length>0&&i.trigger()},[r.language,i]);const k=t=>b(null,null,function*(){c(!0);const{error:d}=yield Y.auth.updateUser({password:t.password});d?ss(d.message):(es(e("password_updated_successfully")),a("/login")),c(!1)}),E=()=>n?s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(rs,{className:"mx-auto h-10 w-10 text-destructive"}),s.jsx("p",{className:"text-destructive-foreground",children:n}),s.jsx(S,{asChild:!0,className:"w-full",children:s.jsx(D,{to:"/login",children:e("back_to_login")})})]}):l?s.jsx(q,j(x({},i),{children:s.jsxs("form",{onSubmit:i.handleSubmit(k),className:"space-y-4",children:[s.jsx(_,{control:i.control,name:"password",render:({field:t})=>s.jsxs(N,{children:[s.jsx(v,{children:e("new_password")}),s.jsx(C,{children:s.jsx(L,x({type:"password"},t))}),s.jsx(F,{})]})}),s.jsx(_,{control:i.control,name:"confirmPassword",render:({field:t})=>s.jsxs(N,{children:[s.jsx(v,{children:e("confirm_new_password")}),s.jsx(C,{children:s.jsx(L,x({type:"password"},t))}),s.jsx(F,{})]})}),s.jsx(S,{type:"submit",className:"w-full",disabled:p,children:e(p?"saving":"update_password")})]})})):s.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-center",children:[s.jsx(as,{className:"h-8 w-8 animate-spin text-gray-400 mb-4"}),s.jsx("p",{className:"text-gray-400",children:e("loading_session")})]});return s.jsxs("div",{className:"relative min-h-screen flex flex-col bg-gray-900 text-white",children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-900 via-transparent to-gray-900 opacity-80"}),s.jsx("div",{className:"absolute inset-0 bg-[url('/grid.svg')] bg-center [mask-image:linear-gradient(180deg,white,rgba(255,255,255,0))]"})]}),s.jsx("main",{className:"relative z-10 flex-grow flex flex-col items-center justify-center p-4",children:s.jsx(K.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},className:"w-full max-w-md",children:s.jsxs(V,{className:"bg-gray-800/50 backdrop-blur-sm border-gray-700/50 text-white",children:[s.jsxs(Z,{className:"text-center",children:[s.jsx(G,{className:"text-3xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-b from-white to-gray-400",children:e("update_password")}),s.jsx(Q,{className:"text-gray-400 pt-2",children:e("update_your_password")})]}),s.jsx(W,{children:E()})]})})}),s.jsx("footer",{className:"relative z-10 w-full bg-transparent",children:s.jsx(X,{})})]})};export{fs as default};
//# sourceMappingURL=UpdatePassword-DFswC76W.js.map
