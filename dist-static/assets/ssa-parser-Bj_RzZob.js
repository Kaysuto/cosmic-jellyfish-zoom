const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./errors-D493Tbg5.js","./streaming-fF1zHaJi.js","./router-42GXI50n.js","./vendor-aQ18W7Az.js"])))=>i.map(i=>d[i]);
var V=Object.defineProperty;var O=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var k=(c,e,s)=>e in c?V(c,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[e]=s,w=(c,e)=>{for(var s in e||(e={}))$.call(e,s)&&k(c,s,e[s]);if(O)for(var s of O(e))v.call(e,s)&&k(c,s,e[s]);return c};var p=(c,e,s)=>k(c,typeof e!="symbol"?e+"":e,s);var N=(c,e,s)=>new Promise((t,a)=>{var i=n=>{try{h(s.next(n))}catch(o){a(o)}},r=n=>{try{h(s.throw(n))}catch(o){a(o)}},h=n=>n.done?t(n.value):Promise.resolve(n.value).then(i,r);h((s=s.apply(c,e)).next())});import{_ as j,K as Y,N as I}from"./streaming-fF1zHaJi.js";import"./router-42GXI50n.js";import"./vendor-aQ18W7Az.js";const b=/^Format:[\s\t]*/,x=/^Style:[\s\t]*/,M=/^Dialogue:[\s\t]*/,S=/[\s\t]*,[\s\t]*/,F=/\{[^}]+\}/g,A=/\\N/g,P=/^\[(.*)[\s\t]?Styles\]$/,T=/^\[(.*)[\s\t]?Events\]$/;class B{constructor(){p(this,"f");p(this,"O",0);p(this,"a",null);p(this,"j",[]);p(this,"k",[]);p(this,"N",null);p(this,"d");p(this,"P",{})}init(e){return N(this,null,function*(){this.f=e,e.errors&&(this.d=(yield j(()=>N(this,null,function*(){const{ParseErrorBuilder:s}=yield import("./errors-D493Tbg5.js");return{ParseErrorBuilder:s}}),__vite__mapDeps([0,1,2,3]),import.meta.url)).ParseErrorBuilder)})}parse(e,s){var t,a;if(this.O)switch(this.O){case 1:if(e==="")this.O=0;else if(x.test(e))if(this.N){const i=e.replace(x,"").split(S);this.S(i)}else this.e((t=this.d)==null?void 0:t.T("Style",s));else b.test(e)?this.N=e.replace(b,"").split(S):T.test(e)&&(this.N=null,this.O=2);break;case 2:if(e==="")this.Q();else if(M.test(e))if(this.Q(),this.N){const i=e.replace(M,"").split(S),r=this.U(i,s);r&&(this.a=r)}else this.e((a=this.d)==null?void 0:a.T("Dialogue",s));else this.a?this.a.text+=`
`+e.replace(F,"").replace(A,`
`):b.test(e)?this.N=e.replace(b,"").split(S):P.test(e)?(this.N=null,this.O=1):T.test(e)&&(this.N=null)}else e===""||(P.test(e)?(this.N=null,this.O=1):T.test(e)&&(this.N=null,this.O=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}Q(){var e,s;this.a&&(this.j.push(this.a),(s=(e=this.f).onCue)==null||s.call(e,this.a),this.a=null)}S(e){let s="Default",t={},a,i="center",r="bottom",h,n=1.2,o,u,f=3,g=[];for(let d=0;d<this.N.length;d++){const L=this.N[d],l=e[d];switch(L){case"Name":s=l;break;case"Fontname":t["font-family"]=l;break;case"Fontsize":t["font-size"]=`calc(${l} / var(--overlay-height))`;break;case"PrimaryColour":const R=_(l);R&&(t["--cue-color"]=R);break;case"BorderStyle":f=parseInt(l,10);break;case"BackColour":u=_(l);break;case"OutlineColour":const y=_(l);y&&(o=y);break;case"Bold":parseInt(l)&&(t["font-weight"]="bold");break;case"Italic":parseInt(l)&&(t["font-style"]="italic");break;case"Underline":parseInt(l)&&(t["text-decoration"]="underline");break;case"StrikeOut":parseInt(l)&&(t["text-decoration"]="line-through");break;case"Spacing":t["letter-spacing"]=l+"px";break;case"AlphaLevel":t.opacity=parseFloat(l);break;case"ScaleX":g.push(`scaleX(${parseFloat(l)/100})`);break;case"ScaleY":g.push(`scaleY(${parseFloat(l)/100})`);break;case"Angle":g.push(`rotate(${l}deg)`);break;case"Shadow":n=parseInt(l,10)*1.2;break;case"MarginL":t["--cue-width"]="auto",t["--cue-left"]=parseFloat(l)+"px";break;case"MarginR":t["--cue-width"]="auto",t["--cue-right"]=parseFloat(l)+"px";break;case"MarginV":h=parseFloat(l);break;case"Outline":a=parseInt(l,10);break;case"Alignment":const m=parseInt(l,10);switch(m>=4&&(r=m>=7?"top":"center"),m%3){case 1:i="start";break;case 2:i="center";break;case 3:i="end";break}}}if(t.R=r,t["--cue-white-space"]="normal",t["--cue-line-height"]="normal",t["--cue-text-align"]=i,r==="center"?(t["--cue-top"]="50%",g.push("translateY(-50%)")):t[`--cue-${r}`]=(h||0)+"px",f===1&&(t["--cue-padding-y"]="0"),(f===1||u)&&(t["--cue-bg-color"]=f===1?"none":u),f===3&&o&&(t["--cue-outline"]=`${a}px solid ${o}`),f===1&&typeof a=="number"){const d=u!=null?u:"#000";t["--cue-text-shadow"]=[o&&E(a*1.2,n*1.2,o),o?E(a*(a/2),n*(a/2),d):E(a,n,d)].filter(Boolean).join(", ")}g.length&&(t["--cue-transform"]=g.join(" ")),this.P[s]=t}U(e,s){const t=this.V(e),a=this.o(t.Start,t.End,s);if(!a)return;const i=new Y(a[0],a[1],""),r=w({},this.P[t.Style]||{}),h=t.Name?`<v ${t.Name}>`:"",n=r.R,o=t.MarginL&&parseFloat(t.MarginL),u=t.MarginR&&parseFloat(t.MarginR),f=t.MarginV&&parseFloat(t.MarginV);return o&&(r["--cue-width"]="auto",r["--cue-left"]=o+"px"),u&&(r["--cue-width"]="auto",r["--cue-right"]=u+"px"),f&&n!=="center"&&(r[`--cue-${n}`]=f+"px"),i.text=h+e.slice(this.N.length-1).join(", ").replace(F,"").replace(A,`
`),delete r.R,Object.keys(r).length&&(i.style=r),i}V(e){const s={};for(let t=0;t<this.N.length;t++)s[this.N[t]]=e[t];return s}o(e,s,t){var r,h,n;const a=I(e),i=I(s);if(a!==null&&i!==null&&i>a)return[a,i];a===null&&this.e((r=this.d)==null?void 0:r.q(e,t)),i===null&&this.e((h=this.d)==null?void 0:h.r(s,t)),a!=null&&i!==null&&i>a&&this.e((n=this.d)==null?void 0:n.s(a,i,t))}e(e){var s,t;if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;(t=(s=this.f).onError)==null||t.call(s,e)}}}function _(c){const e=parseInt(c.replace("&H",""),16);if(e>=0){const t=(e>>24&255^255)/255,a=e>>16&255,i=e>>8&255;return"rgba("+[e&255,i,a,t].join(",")+")"}return null}function E(c,e,s){const t=Math.ceil(2*Math.PI*c);let a="";for(let i=0;i<t;i++){const r=2*Math.PI*i/t;a+=c*Math.cos(r)+"px "+e*Math.sin(r)+"px 0 "+s+(i==t-1?"":",")}return a}function X(){return new B}export{B as SSAParser,X as default};
//# sourceMappingURL=ssa-parser-Bj_RzZob.js.map
