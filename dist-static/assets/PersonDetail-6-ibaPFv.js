var Y=Object.defineProperty,G=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var I=(r,s,t)=>s in r?Y(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,R=(r,s)=>{for(var t in s||(s={}))q.call(s,t)&&I(r,t,s[t]);if(T)for(var t of T(s))H.call(s,t)&&I(r,t,s[t]);return r},$=(r,s)=>G(r,W(s));var M=(r,s,t)=>new Promise((f,y)=>{var D=n=>{try{l(t.next(n))}catch(d){y(d)}},j=n=>{try{l(t.throw(n))}catch(d){y(d)}},l=n=>n.done?f(n.value):Promise.resolve(n.value).then(D,j);l((t=t.apply(r,s)).next())});import{j as e}from"./ui-DslYdUPK.js";import{h as K,u as O,r as p,L as Q}from"./router-42GXI50n.js";import{u as V,b as X,S as o,B as _,m as Z,C as B,a2 as ee,p as F,M as se,x as ae,ah as te,F as re,t as le,s as E,d as ie}from"./index-Cw6WSGfP.js";import{A as z}from"./arrow-left-Db81hexG.js";import{T as ne}from"./tv-MG6c8U_0.js";import{C as oe}from"./chevron-left-BG9g9Eau.js";import"./vendor-aQ18W7Az.js";import"./streaming-fF1zHaJi.js";import"./utils-D-N2hrcs.js";const Ne=()=>{const{id:r}=K(),{t:s,i18n:t}=V(),f=O(),{jellyfinUrl:y,loading:D,error:j}=X(),[l,n]=p.useState(null),[d,C]=p.useState([]),[J,S]=p.useState(!0),[h,A]=p.useState(1),k=18;p.useEffect(()=>{window.scrollTo(0,0),M(null,null,function*(){if(r){S(!0);try{const u=E.functions.invoke("get-person-details",{body:{personId:r,language:t.language}}),g=E.functions.invoke("get-person-credits",{body:{personId:r,language:t.language}}),[P,b]=yield Promise.all([u,g]);if(P.error)throw P.error;if(n(P.data),b.error)throw b.error;const v=[...b.data.cast||[],...b.data.crew||[]].filter((i,c,m)=>i.id&&c===m.findIndex(x=>x.id===i.id)).filter(i=>i.release_date||i.first_air_date).sort((i,c)=>{const m=new Date(i.release_date||i.first_air_date).getTime(),x=new Date(c.release_date||c.first_air_date).getTime();return(isNaN(x)?0:x)-(isNaN(m)?0:m)}),L=v.map(i=>i.id);if(L.length>0){const{data:i,error:c}=yield E.from("catalog_items").select("tmdb_id").in("tmdb_id",L);if(c)console.error("Error checking catalog availability for filmography",c),C(v);else{const m=new Set(i.map(w=>w.tmdb_id)),x=v.map(w=>$(R({},w),{isAvailable:m.has(w.id)}));C(x)}}else C(v)}catch(u){ie(u.message)}finally{S(!1)}}})},[r,t.language]);const N=Math.ceil(d.length/k),U=d.slice((h-1)*k,h*k);return J?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(o,{className:"h-10 w-32 mb-8"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx(o,{className:"aspect-[2/3] w-full rounded-lg"}),e.jsx(o,{className:"h-6 w-3/4 mt-4"}),e.jsx(o,{className:"h-4 w-1/2 mt-2"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsx(o,{className:"h-8 w-1/3"}),e.jsx(o,{className:"h-32 w-full"}),e.jsx(o,{className:"h-8 w-1/3 mt-8"}),e.jsx(o,{className:"h-64 w-full"})]})]})]}):l?j?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(_,{variant:"outline",onClick:()=>f(-1),className:"mb-8",children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," ",s("back")]}),e.jsx("div",{className:"text-red-500 p-4 rounded-lg bg-red-500/10 border border-red-500/20",children:e.jsxs("p",{children:["Erreur de configuration Jellyfin : ",j]})})]}):e.jsxs(Z.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto px-4 py-8",children:[e.jsxs(_,{variant:"outline",onClick:()=>f(-1),className:"mb-8",children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," ",s("back")]}),e.jsxs("div",{className:"grid md:grid-cols-3 lg:grid-cols-4 gap-8 items-start",children:[e.jsx("div",{className:"md:col-span-1 lg:col-span-1",children:e.jsxs(B,{className:"overflow-hidden sticky top-24",children:[l.profile_path?e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${l.profile_path}`,alt:l.name,className:"w-full h-auto"}):e.jsx("div",{className:"aspect-[2/3] bg-muted flex items-center justify-center text-muted-foreground",children:e.jsx(ee,{className:"h-24 w-24"})}),e.jsxs(F,{className:"p-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:l.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s(l.known_for_department.toLowerCase())}),l.birthday&&e.jsxs("div",{className:"flex items-center gap-2 mt-4 text-sm",children:[e.jsx(se,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:new Date(l.birthday).toLocaleDateString(t.language,{year:"numeric",month:"long",day:"numeric"})})]}),l.place_of_birth&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l.place_of_birth})]})]})}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-bold mb-4",children:s("biography")}),e.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap leading-relaxed",children:l.biography||s("no_biography_available")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-bold mb-4",children:s("filmography")}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:U.map(a=>{const u=a.release_date?new Date(a.release_date).getFullYear():a.first_air_date?new Date(a.first_air_date).getFullYear():"N/A",g=a.title||a.name;return e.jsx(Q,{to:`/media/${a.media_type}/${a.id}`,className:"text-left",children:e.jsxs(B,{className:"overflow-hidden bg-muted/20 border-border h-full transition-transform hover:scale-105 group relative",children:[a.isAvailable&&e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsxs(ae,{className:"bg-green-600 hover:bg-green-700 text-white border-transparent",children:[e.jsx(te,{className:"h-3 w-3 mr-1"}),s("available")]})}),e.jsx("div",{className:"aspect-[2/3] bg-muted",children:a.poster_path?e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${a.poster_path}`,alt:g,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:a.media_type==="movie"?e.jsx(re,{className:"h-12 w-12"}):e.jsx(ne,{className:"h-12 w-12"})})}),e.jsxs(F,{className:"p-2",children:[e.jsx("p",{className:"font-bold text-sm truncate",title:g,children:g}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",title:a.character||a.job,children:a.character||a.job}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u})]})]})},`${a.id}-${a.job||a.character}`)})}),N>1&&e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-8",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>A(a=>Math.max(1,a-1)),disabled:h===1,children:[e.jsx(oe,{className:"h-4 w-4 mr-1"}),s("previous")]}),e.jsx("span",{className:"text-sm text-muted-foreground font-mono",children:s("page_x_of_y",{x:h,y:N})}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>A(a=>Math.min(N,a+1)),disabled:h===N,children:[s("next"),e.jsx(le,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]}):e.jsx("div",{className:"container mx-auto px-4 py-8 text-center",children:s("no_results_found")})};export{Ne as default};
//# sourceMappingURL=PersonDetail-6-ibaPFv.js.map
