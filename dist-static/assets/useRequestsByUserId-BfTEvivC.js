var q=(e,c,s)=>new Promise((i,r)=>{var n=a=>{try{t(s.next(a))}catch(l){r(l)}},o=a=>{try{t(s.throw(a))}catch(l){r(l)}},t=a=>a.done?i(a.value):Promise.resolve(a.value).then(n,o);t((s=s.apply(e,c)).next())});import{r as u}from"./router-42GXI50n.js";import{s as f}from"./index-Cw6WSGfP.js";const p=e=>{const[c,s]=u.useState([]),[i,r]=u.useState(!0),n=u.useCallback(()=>q(null,null,function*(){if(!e){r(!1);return}r(!0);const{data:o,error:t}=yield f.from("media_requests").select("id, title, status, requested_at, media_type, poster_path, tmdb_id").eq("user_id",e).order("requested_at",{ascending:!1});t?(console.error("Error fetching user requests:",t),s([])):s(o),r(!1)}),[e]);return u.useEffect(()=>{if(!e){s([]),r(!1);return}n();const o=f.channel(`user-requests-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"media_requests",filter:`user_id=eq.${e}`},t=>{console.log("Change received!",t),n()}).subscribe();return()=>{f.removeChannel(o)}},[e,n]),{requests:c,loading:i,refreshRequests:n}};export{p as u};
//# sourceMappingURL=useRequestsByUserId-BfTEvivC.js.map
