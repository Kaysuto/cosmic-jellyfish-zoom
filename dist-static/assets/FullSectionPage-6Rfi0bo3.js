var X=Object.defineProperty,Z=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var O=(a,s,t)=>s in a?X(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,N=(a,s)=>{for(var t in s||(s={}))ee.call(s,t)&&O(a,t,s[t]);if(q)for(var t of q(s))se.call(s,t)&&O(a,t,s[t]);return a},S=(a,s)=>Z(a,$(s));var A=(a,s,t)=>new Promise((f,c)=>{var j=i=>{try{d(t.next(i))}catch(n){c(n)}},_=i=>{try{d(t.throw(i))}catch(n){c(n)}},d=i=>i.done?f(i.value):Promise.resolve(i.value).then(j,_);d((t=t.apply(a,s)).next())});import{j as e}from"./ui-DslYdUPK.js";import{h as ae,u as te,d as re,r as o,L as D}from"./router-42GXI50n.js";import{u as oe,a as ie,b as ne,s as E,d as le,B as p,V as ce,W as de,Y as me,a0 as ue,t as pe,S as C}from"./index-Cw6WSGfP.js";import{M as xe}from"./MediaGrid-D_gViZ45.js";import{R as he}from"./RequestModal-Dh-rgp6A.js";import{S as ge}from"./switch-goiC7JOz.js";import{L as fe}from"./label-BjJg9FZ3.js";import{A as B}from"./arrow-left-Db81hexG.js";import{C as je}from"./chevrons-up-down-HbC2k5Zi.js";import{C as _e}from"./chevron-left-BG9g9Eau.js";import"./vendor-aQ18W7Az.js";import"./streaming-fF1zHaJi.js";import"./utils-D-N2hrcs.js";import"./hourglass-d_tFP0Ab.js";import"./plus-BCI7Qmoy.js";import"./dialog-DtG0Tqk0.js";import"./input-B7M3MPRI.js";import"./textarea-BGhclJcN.js";import"./index-Cco2FRbQ.js";const Te=()=>{const{section:a}=ae(),{t:s,i18n:t}=oe();te(),re();const{session:f}=ie(),{error:c}=ne(),[j,_]=o.useState([]),[d,i]=o.useState(!0),[n,x]=o.useState(1),[h,I]=o.useState(1),[b,F]=o.useState("popularity.desc"),[m,P]=o.useState(!1),[T,M]=o.useState(!1),[J,G]=o.useState(null),k={"popularity.desc":s("sort_popularity_desc"),"vote_average.desc":s("sort_vote_average_desc"),"release_date.desc":s("sort_release_date_desc")},R=o.useCallback(()=>A(null,null,function*(){var r;if(a){i(!0);try{const{data:l,error:L}=yield E.functions.invoke("discover-media",{body:{section:a,language:t.language,page:n,sortBy:b,availableOnly:m}});if(L)throw L;const u=l.results;let v=u;if(!m&&u.length>0){const w=u.map(y=>y.id),{data:K,error:Q}=yield E.from("catalog_items").select("tmdb_id").in("tmdb_id",w);if(!Q){const y=new Set(K.map(g=>g.tmdb_id));v=u.map(g=>S(N({},g),{isAvailable:y.has(g.id)}))}}else m&&(v=u.map(w=>S(N({},w),{isAvailable:!0})));_(v),I(Math.min((r=l.total_pages)!=null?r:1,500))}catch(l){le(l.message)}finally{i(!1)}}}),[a,t.language,n,b,m]);o.useEffect(()=>{window.scrollTo(0,0),R()},[R]);const U=r=>{F(r),x(1)},V=r=>{P(r),x(1)},W=r=>{G(r),M(!0)},Y=o.useMemo(()=>{switch(a){case"animations":return s("catalog_section_animations");case"animes":return s("catalog_section_animes");case"films":return s("catalog_section_films");case"series":return s("catalog_section_series");default:return s("catalog")}},[a,s]),z=o.useMemo(()=>{switch(a){case"animations":return s("catalog_section_animations_desc");case"animes":return s("catalog_section_animes_desc");case"films":return s("catalog_section_films_desc");case"series":return s("catalog_section_series_desc");default:return""}},[a,s]),H=()=>e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:[...Array(18)].map((r,l)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"aspect-[2/3] w-full rounded-lg"}),e.jsx(C,{className:"h-4 w-3/4"}),e.jsx(C,{className:"h-4 w-1/2"})]},l))});return a?c?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(p,{asChild:!0,variant:"outline",className:"mb-6",children:e.jsxs(D,{to:"/catalog",children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," ",s("back_to_catalog")]})}),e.jsx("div",{className:"text-red-500 p-4 rounded-lg bg-red-500/10 border border-red-500/20",children:e.jsxs("p",{children:["Erreur de configuration Jellyfin : ",c]})})]}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx(p,{asChild:!0,variant:"outline",className:"mb-4",children:e.jsxs(D,{to:"/catalog",children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," ",s("back_to_catalog")]})}),e.jsx("h1",{className:"text-4xl font-bold tracking-tight mb-2",children:Y}),e.jsx("p",{className:"text-muted-foreground",children:z})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mb-6",children:[e.jsxs(ce,{modal:!1,children:[e.jsx(de,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"w-full sm:w-[200px] justify-between",children:[k[b],e.jsx(je,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(me,{className:"w-[200px]",children:Object.entries(k).map(([r,l])=>e.jsx(ue,{onSelect:()=>U(r),children:l},r))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{id:"available-only",checked:m,onCheckedChange:V}),e.jsx(fe,{htmlFor:"available-only",children:s("available_in_catalog")})]})]}),d?e.jsx(H,{}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{items:j,showRequestButton:!!f,onRequest:W}),h>1&&e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-8",children:[e.jsxs(p,{variant:"outline",onClick:()=>x(r=>Math.max(1,r-1)),disabled:n===1,children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),s("previous")]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s("page")," ",n," / ",h]}),e.jsxs(p,{variant:"outline",onClick:()=>x(r=>Math.min(h,r+1)),disabled:n===h,children:[s("next"),e.jsx(pe,{className:"ml-2 h-4 w-4"})]})]})]}),e.jsx(he,{open:T,onOpenChange:M,item:J})]}):e.jsx("div",{className:"container mx-auto px-4 py-8 text-center",children:s("invalid_section")})};export{Te as default};
//# sourceMappingURL=FullSectionPage-6Rfi0bo3.js.map
