var k=Object.defineProperty;var H=(s,e,t)=>e in s?k(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var h=(s,e,t)=>H(s,typeof e!="symbol"?e+"":e,t);var c=(s,e,t)=>new Promise((i,r)=>{var u=a=>{try{n(t.next(a))}catch(d){r(d)}},o=a=>{try{n(t.throw(a))}catch(d){r(d)}},n=a=>a.done?i(a.value):Promise.resolve(a.value).then(u,o);n((t=t.apply(s,e)).next())});import{o as T,T as I,A as p,d as E,B as v,l,C as f,F as P,D as q,G as A,H as g}from"./streaming-fF1zHaJi.js";import{H as m}from"./provider-2S-Iw40p.js";import"./router-42GXI50n.js";import"./vendor-aQ18W7Az.js";class G{constructor(e,t){this.qa=e,this.ph=t,e.textTracks.onaddtrack=this.va.bind(this),T(this.Eh.bind(this))}va(e){const t=e.track;if(!t||x(this.qa,t))return;const i=new I({id:t.id,kind:t.kind,label:t.label,language:t.language,type:"vtt"});i[p]={track:t},i[E]=2,i[v]=!0;let r=0;const u=o=>{if(t.cues)for(let n=r;n<t.cues.length;n++)i.addCue(t.cues[n],o),r++};u(e),t.oncuechange=u,this.ph.textTracks.add(i,e),i.setMode(t.mode,e)}Eh(){var e;this.qa.textTracks.onaddtrack=null;for(const t of this.ph.textTracks){const i=(e=t[p])==null?void 0:e.track;i!=null&&i.oncuechange&&(i.oncuechange=null)}}}function x(s,e){return Array.from(s.children).find(t=>t.track===e)}class b{constructor(e,t){h(this,"Hc",(e,t)=>{this.j.delegate.p("picture-in-picture-change",{detail:e,trigger:t})});this.qa=e,this.j=t,l(this.qa,"enterpictureinpicture",this.Fh.bind(this)),l(this.qa,"leavepictureinpicture",this.Gh.bind(this))}get active(){return document.pictureInPictureElement===this.qa}get supported(){return f(this.qa)}enter(){return c(this,null,function*(){return this.qa.requestPictureInPicture()})}exit(){return document.exitPictureInPicture()}Fh(e){this.Hc(!0,e)}Gh(e){this.Hc(!1,e)}}class w{constructor(e,t){h(this,"Ga","inline");this.qa=e,this.j=t,l(this.qa,"webkitpresentationmodechanged",this.Kh.bind(this))}get Jh(){return P(this.qa)}Ih(e){return c(this,null,function*(){this.Ga!==e&&this.qa.webkitSetPresentationMode(e)})}Kh(){var t;const e=this.Ga;this.Ga=this.qa.webkitPresentationMode,(t=this.j.player)==null||t.dispatchEvent(new q("video-presentation-change",{detail:this.Ga,trigger:event})),["fullscreen","picture-in-picture"].forEach(i=>{(this.Ga===i||e===i)&&this.j.delegate.p(`${i}-change`,{detail:this.Ga===i,trigger:event})})}}class y{constructor(e){this.Hh=e}get active(){return this.Hh.Ga==="fullscreen"}get supported(){return this.Hh.Jh}enter(){return c(this,null,function*(){this.Hh.Ih("fullscreen")})}exit(){return c(this,null,function*(){this.Hh.Ih("inline")})}}class V{constructor(e){this.Hh=e}get active(){return this.Hh.Ga==="picture-in-picture"}get supported(){return this.Hh.Jh}enter(){return c(this,null,function*(){this.Hh.Ih("picture-in-picture")})}exit(){return c(this,null,function*(){this.Hh.Ih("inline")})}}class j extends m{constructor(t,i){super(t);h(this,"$$PROVIDER_TYPE","VIDEO");h(this,"fullscreen");h(this,"pictureInPicture");if(P(t)){const r=new w(t,i);this.fullscreen=new y(r),this.pictureInPicture=new V(r)}else f(t)&&(this.pictureInPicture=new b(t,i))}get type(){return"video"}setup(t){super.setup(t),A(this.video)&&new G(this.video,t),t.textRenderers[g](this.video),T(()=>{t.textRenderers[g](null)}),this.type==="video"&&t.delegate.p("provider-setup",{detail:this})}get video(){return this.j}}export{j as VideoProvider};
//# sourceMappingURL=provider-pkq8ONR5.js.map
