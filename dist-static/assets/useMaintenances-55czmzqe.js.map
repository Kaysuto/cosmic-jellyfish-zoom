{"version":3,"file":"useMaintenances-55czmzqe.js","sources":["../../src/hooks/useMaintenances.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { RealtimeChannel } from '@supabase/supabase-js';\n\nexport interface Maintenance {\n  id: string;\n  service_id: string | null;\n  title: string;\n  description: string | null;\n  start_time: string;\n  end_time: string;\n  created_at: string;\n  updated_at: string;\n  author_id: string | null;\n  services: { name: string } | null;\n}\n\nexport const useMaintenances = () => {\n  const [maintenances, setMaintenances] = useState<Maintenance[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  const fetchMaintenances = useCallback(async () => {\n    setLoading(true);\n    const { data, error } = await supabase\n      .from('scheduled_maintenances')\n      .select('*, services(name)')\n      .order('start_time', { ascending: false });\n    \n    if (error) {\n      console.error('Error fetching maintenances:', error);\n    } else {\n      setMaintenances(data as Maintenance[] || []);\n    }\n    setLoading(false);\n  }, []);\n\n  useEffect(() => {\n    fetchMaintenances();\n\n    const channel: RealtimeChannel = supabase\n      .channel('maintenances-changes')\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'scheduled_maintenances',\n        },\n        () => {\n          fetchMaintenances();\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [fetchMaintenances]);\n\n  return { maintenances, loading, refreshMaintenances: fetchMaintenances };\n};"],"names":["useMaintenances","maintenances","setMaintenances","useState","loading","setLoading","fetchMaintenances","useCallback","__async","data","error","supabase","useEffect","channel"],"mappings":"yRAiBO,MAAMA,EAAkB,IAAM,CACnC,KAAM,CAACC,EAAcC,CAAe,EAAIC,EAAAA,SAAwB,CAAA,CAAE,EAC5D,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EAErCG,EAAoBC,EAAAA,YAAY,IAAYC,EAAA,sBAChDH,EAAW,EAAI,EACf,KAAM,CAAE,KAAAI,EAAM,MAAAC,CAAA,EAAU,MAAMC,EAC3B,KAAK,wBAAwB,EAC7B,OAAO,mBAAmB,EAC1B,MAAM,aAAc,CAAE,UAAW,GAAO,EAEvCD,EACF,QAAQ,MAAM,+BAAgCA,CAAK,EAEnDR,EAAgBO,GAAyB,EAAE,EAE7CJ,EAAW,EAAK,CAClB,GAAG,CAAA,CAAE,EAELO,OAAAA,EAAAA,UAAU,IAAM,CACdN,EAAA,EAEA,MAAMO,EAA2BF,EAC9B,QAAQ,sBAAsB,EAC9B,GACC,mBACA,CACE,MAAO,IACP,OAAQ,SACR,MAAO,wBAAA,EAET,IAAM,CACJL,EAAA,CACF,CAAA,EAED,UAAA,EAEH,MAAO,IAAM,CACXK,EAAS,cAAcE,CAAO,CAChC,CACF,EAAG,CAACP,CAAiB,CAAC,EAEf,CAAE,aAAAL,EAAc,QAAAG,EAAS,oBAAqBE,CAAA,CACvD"}