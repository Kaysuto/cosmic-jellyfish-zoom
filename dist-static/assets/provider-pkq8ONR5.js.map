{"version":3,"file":"provider-pkq8ONR5.js","sources":["../../node_modules/vidstack/dist/prod/providers/video/native-hls-text-tracks.js","../../node_modules/vidstack/dist/prod/providers/video/picture-in-picture.js","../../node_modules/vidstack/dist/prod/providers/video/presentation/video-presentation.js","../../node_modules/vidstack/dist/prod/providers/video/provider.js"],"sourcesContent":["import { onDispose } from 'maverick.js';\nimport { G as TextTrack, Y as TEXT_TRACK_NATIVE, H as TEXT_TRACK_READY_STATE, Z as TEXT_TRACK_NATIVE_HLS } from '../../media-core.js';\n\nclass NativeHLSTextTracks {\n  constructor(_video, _context) {\n    this.qa = _video;\n    this.ph = _context;\n    _video.textTracks.onaddtrack = this.va.bind(this);\n    onDispose(this.Eh.bind(this));\n  }\n  va(event) {\n    const nativeTrack = event.track;\n    if (!nativeTrack || findTextTrackElement(this.qa, nativeTrack))\n      return;\n    const track = new TextTrack({\n      id: nativeTrack.id,\n      kind: nativeTrack.kind,\n      label: nativeTrack.label,\n      language: nativeTrack.language,\n      type: \"vtt\"\n    });\n    track[TEXT_TRACK_NATIVE] = { track: nativeTrack };\n    track[TEXT_TRACK_READY_STATE] = 2;\n    track[TEXT_TRACK_NATIVE_HLS] = true;\n    let lastIndex = 0;\n    const onCueChange = (event2) => {\n      if (!nativeTrack.cues)\n        return;\n      for (let i = lastIndex; i < nativeTrack.cues.length; i++) {\n        track.addCue(nativeTrack.cues[i], event2);\n        lastIndex++;\n      }\n    };\n    onCueChange(event);\n    nativeTrack.oncuechange = onCueChange;\n    this.ph.textTracks.add(track, event);\n    track.setMode(nativeTrack.mode, event);\n  }\n  Eh() {\n    this.qa.textTracks.onaddtrack = null;\n    for (const track of this.ph.textTracks) {\n      const nativeTrack = track[TEXT_TRACK_NATIVE]?.track;\n      if (nativeTrack?.oncuechange)\n        nativeTrack.oncuechange = null;\n    }\n  }\n}\nfunction findTextTrackElement(video, track) {\n  return Array.from(video.children).find((el) => el.track === track);\n}\n\nexport { NativeHLSTextTracks as N };\n","import { listenEvent } from 'maverick.js/std';\nimport { _ as canUsePictureInPicture } from '../../media-core.js';\n\nclass VideoPictureInPicture {\n  constructor(_video, _media) {\n    this.qa = _video;\n    this.j = _media;\n    listenEvent(this.qa, \"enterpictureinpicture\", this.Fh.bind(this));\n    listenEvent(this.qa, \"leavepictureinpicture\", this.Gh.bind(this));\n  }\n  get active() {\n    return document.pictureInPictureElement === this.qa;\n  }\n  get supported() {\n    return canUsePictureInPicture(this.qa);\n  }\n  async enter() {\n    return this.qa.requestPictureInPicture();\n  }\n  exit() {\n    return document.exitPictureInPicture();\n  }\n  Fh(event) {\n    this.Hc(true, event);\n  }\n  Gh(event) {\n    this.Hc(false, event);\n  }\n  Hc = (active, event) => {\n    this.j.delegate.p(\"picture-in-picture-change\", {\n      detail: active,\n      trigger: event\n    });\n  };\n}\n\nexport { VideoPictureInPicture as V };\n","import { listenEvent, DOMEvent } from 'maverick.js/std';\nimport { $ as canUseVideoPresentation } from '../../../media-core.js';\n\nclass VideoPresentation {\n  constructor(_video, _media) {\n    this.qa = _video;\n    this.j = _media;\n    listenEvent(this.qa, \"webkitpresentationmodechanged\", this.Kh.bind(this));\n  }\n  Ga = \"inline\";\n  get Jh() {\n    return canUseVideoPresentation(this.qa);\n  }\n  async Ih(mode) {\n    if (this.Ga === mode)\n      return;\n    this.qa.webkitSetPresentationMode(mode);\n  }\n  Kh() {\n    const prevMode = this.Ga;\n    this.Ga = this.qa.webkitPresentationMode;\n    this.j.player?.dispatchEvent(\n      new DOMEvent(\"video-presentation-change\", {\n        detail: this.Ga,\n        trigger: event\n      })\n    );\n    [\"fullscreen\", \"picture-in-picture\"].forEach((type) => {\n      if (this.Ga === type || prevMode === type) {\n        this.j.delegate.p(`${type}-change`, {\n          detail: this.Ga === type,\n          trigger: event\n        });\n      }\n    });\n  }\n}\nclass FullscreenPresentationAdapter {\n  constructor(_presentation) {\n    this.Hh = _presentation;\n  }\n  get active() {\n    return this.Hh.Ga === \"fullscreen\";\n  }\n  get supported() {\n    return this.Hh.Jh;\n  }\n  async enter() {\n    this.Hh.Ih(\"fullscreen\");\n  }\n  async exit() {\n    this.Hh.Ih(\"inline\");\n  }\n}\nclass PIPPresentationAdapter {\n  constructor(_presentation) {\n    this.Hh = _presentation;\n  }\n  get active() {\n    return this.Hh.Ga === \"picture-in-picture\";\n  }\n  get supported() {\n    return this.Hh.Jh;\n  }\n  async enter() {\n    this.Hh.Ih(\"picture-in-picture\");\n  }\n  async exit() {\n    this.Hh.Ih(\"inline\");\n  }\n}\n\nexport { FullscreenPresentationAdapter as F, PIPPresentationAdapter as P, VideoPresentation as V };\n","import { onDispose } from 'maverick.js';\nimport { $ as canUseVideoPresentation, _ as canUsePictureInPicture, X as canPlayHLSNatively, a0 as ATTACH_VIDEO } from '../../media-core.js';\nimport { H as HTMLMediaProvider } from '../html/provider.js';\nimport { N as NativeHLSTextTracks } from './native-hls-text-tracks.js';\nimport { V as VideoPictureInPicture } from './picture-in-picture.js';\nimport { V as VideoPresentation, F as FullscreenPresentationAdapter, P as PIPPresentationAdapter } from './presentation/video-presentation.js';\nimport 'maverick.js/element';\nimport 'maverick.js/std';\nimport '../type-check.js';\nimport '../audio/loader.js';\nimport 'maverick.js/dom';\nimport '../hls/loader.js';\nimport './loader.js';\nimport '../html/htmlâ€“media-events.js';\nimport '../hls/hls.js';\nimport '../../media-ui.js';\nimport '../../icons/icon.js';\nimport 'media-captions';\nimport '../html/native-audio-tracks.js';\n\nclass VideoProvider extends HTMLMediaProvider {\n  $$PROVIDER_TYPE = \"VIDEO\";\n  get type() {\n    return \"video\";\n  }\n  fullscreen;\n  pictureInPicture;\n  constructor(video, context) {\n    super(video);\n    if (canUseVideoPresentation(video)) {\n      const presentation = new VideoPresentation(video, context);\n      this.fullscreen = new FullscreenPresentationAdapter(presentation);\n      this.pictureInPicture = new PIPPresentationAdapter(presentation);\n    } else if (canUsePictureInPicture(video)) {\n      this.pictureInPicture = new VideoPictureInPicture(video, context);\n    }\n  }\n  setup(context) {\n    super.setup(context);\n    if (canPlayHLSNatively(this.video)) {\n      new NativeHLSTextTracks(this.video, context);\n    }\n    context.textRenderers[ATTACH_VIDEO](this.video);\n    onDispose(() => {\n      context.textRenderers[ATTACH_VIDEO](null);\n    });\n    if (this.type === \"video\")\n      context.delegate.p(\"provider-setup\", { detail: this });\n  }\n  /**\n   * The native HTML `<video>` element.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement}\n   */\n  get video() {\n    return this.j;\n  }\n}\n\nexport { VideoProvider };\n"],"names":["NativeHLSTextTracks","_video","_context","onDispose","event","nativeTrack","findTextTrackElement","track","TextTrack","TEXT_TRACK_NATIVE","TEXT_TRACK_READY_STATE","TEXT_TRACK_NATIVE_HLS","lastIndex","onCueChange","event2","i","_a","video","el","VideoPictureInPicture","_media","__publicField","active","listenEvent","canUsePictureInPicture","__async","VideoPresentation","canUseVideoPresentation","mode","prevMode","DOMEvent","type","FullscreenPresentationAdapter","_presentation","PIPPresentationAdapter","VideoProvider","HTMLMediaProvider","context","presentation","canPlayHLSNatively","ATTACH_VIDEO"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}