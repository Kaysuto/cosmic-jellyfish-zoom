var N=(a,c,r)=>new Promise((d,o)=>{var m=t=>{try{i(r.next(t))}catch(n){o(n)}},l=t=>{try{i(r.throw(t))}catch(n){o(n)}},i=t=>t.done?d(t.value):Promise.resolve(t.value).then(m,l);i((r=r.apply(a,c)).next())});import{j as e}from"./ui-DslYdUPK.js";import{r as A,L as y}from"./router-42GXI50n.js";import{u as D,a as k,v as M,w as S,m as _,aj as b,S as R,C as T,n as $,x as B,p as F,M as E,al as L,B as v,A as z,f as H,g as I,h as U,i as K,j as O,k as P,l as Q,ae as V,F as q,s as G,d as J,K as W}from"./index-Cw6WSGfP.js";import{u as X}from"./useRequestsByUserId-BfTEvivC.js";import{C as w}from"./clapperboard-doYtbmqY.js";import{T as Y}from"./tv-MG6c8U_0.js";import{f as Z}from"./format-ulCIpsJ0.js";import"./vendor-aQ18W7Az.js";import"./streaming-fF1zHaJi.js";import"./utils-D-N2hrcs.js";const me=()=>{var u;const{t:a,i18n:c}=D(),{session:r}=k(),{requests:d,loading:o,refreshRequests:m}=X((u=r==null?void 0:r.user)==null?void 0:u.id),[l,i]=A.useState(null),t=c.language==="fr"?M:S,n={pending:{text:a("status_pending"),className:"bg-gray-500/20 text-gray-400 border-gray-500/30",ring:"ring-gray-500/30"},approved:{text:a("status_approved"),className:"bg-blue-500/20 text-blue-400 border-blue-500/30",ring:"ring-blue-500/30"},rejected:{text:a("status_rejected"),className:"bg-red-500/20 text-red-400 border-red-500/30",ring:"ring-red-500/30"},available:{text:a("status_available"),className:"bg-green-500/20 text-green-400 border-green-500/30",ring:"ring-green-500/30"}},g={movie:e.jsx(q,{className:"h-4 w-4"}),tv:e.jsx(Y,{className:"h-4 w-4"}),anime:e.jsx(w,{className:"h-4 w-4"})},C=()=>N(null,null,function*(){if(!l)return;const{error:s}=yield G.from("media_requests").delete().eq("id",l.id);s?J(a("error_deleting_requests")):(W(a("requests_deleted_successfully")),m()),i(null)});return e.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[e.jsx(b,{className:"h-8 w-8"}),a("my_requests")]}),e.jsx("p",{className:"text-muted-foreground",children:a("my_requests_description")})]}),o?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,x)=>e.jsx(R,{className:"h-64 w-full rounded-lg"},x))}):d.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map((s,x)=>{var p,h,j,f;return e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:x*.05},children:e.jsxs(T,{className:`h-full flex flex-col overflow-hidden ring-2 ring-transparent transition-all ${(p=n[s.status])==null?void 0:p.ring}`,children:[e.jsxs($,{className:"flex flex-row items-start gap-4 p-4",children:[s.poster_path?e.jsx("img",{src:`https://image.tmdb.org/t/p/w154${s.poster_path}`,alt:(h=s.title)!=null?h:"",className:"h-28 w-20 rounded-md object-cover"}):e.jsx("div",{className:"h-28 w-20 rounded-md bg-muted flex items-center justify-center",children:g[s.media_type]||e.jsx(w,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(B,{variant:"outline",className:`mb-2 ${(j=n[s.status])==null?void 0:j.className}`,children:(f=n[s.status])==null?void 0:f.text}),e.jsx(y,{to:`/media/${s.media_type}/${s.tmdb_id}`,className:"font-semibold leading-tight hover:underline text-lg",children:s.title})]})]}),e.jsxs(F,{className:"p-4 pt-0 flex-grow",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:Z(new Date(s.requested_at),"d MMMM yyyy",{locale:t})})]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[g[s.media_type],e.jsx("span",{className:"ml-2 capitalize",children:a(s.media_type)})]})]}),e.jsx(L,{className:"p-2 bg-muted/30 border-t",children:e.jsx(v,{variant:"destructive",size:"sm",className:"w-full",onClick:()=>i(s),children:a("delete")})})]})},s.id)})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(b,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold",children:a("no_requests_yet")}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:a("my_requests_empty_state_desc")}),e.jsx(v,{asChild:!0,className:"mt-6",children:e.jsx(y,{to:"/catalog",children:a("go_to_catalog")})})]}),e.jsx(z,{open:!!l,onOpenChange:s=>!s&&i(null),children:e.jsxs(H,{children:[e.jsxs(I,{children:[e.jsx(U,{children:a("confirm_delete_title")}),e.jsx(K,{children:a("confirm_delete_request",{title:l==null?void 0:l.title})})]}),e.jsxs(O,{children:[e.jsx(P,{onClick:()=>i(null),children:a("cancel")}),e.jsx(Q,{onClick:C,className:V({variant:"destructive"}),children:a("delete")})]})]})})]})};export{me as default};
//# sourceMappingURL=MyRequests-DKlgui9g.js.map
